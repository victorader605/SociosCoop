{% extends "header.html" %}{% load static %} <!-- aqui adentro va el HTML -->
{% block title %}Simulacion Credito{% endblock %} 
{% block content %}   <!-- aqui adentro va el HTML -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulacion de credito</title>
    <link rel="stylesheet" href="{% static 'css/my.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap/bootstrap.min.css' %}">
    

    
    <title>Selector de Fecha con Bootstrap (en Español)</title>
    <!-- Bootstrap CSS -->
    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">-->
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    <!-- Bootstrap Datepicker CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <!-- Bootstrap Datepicker JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <!-- Bootstrap Datepicker Spanish localization -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/locales/bootstrap-datepicker.es.min.js"></script>

    <!-- Abrir modal automaticamente cuando tenga datos 
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>-->


</head>
<body>

      <main class="container"> 
            <div class="d-flex align-items-center justify-content-center p-3 my-3 bg-purple rounded shadow-sm">
                <!-- Imagen a la izquierda -->
                <img class="me-3" src="{% static 'img/iconos/credito.png' %}" alt="" style="width: 75px; height: auto;">
                
                <!-- Contenedor de texto centrado -->
                <div class="lh-1 text-center">
                    <h1 class="h6 mb-0 text-black lh-1">Simulacion de crédito</h1>
                    <small class="text-black">Since 2011</small>
                </div>
            </div>


        <div class="my-3 p-3 bg-body rounded shadow-sm">
            <form action="/simulaCredito/formulario" class="row g-3 needs-validation" method="POST" novalidate>{% csrf_token %} 
                
                <div class="d-flex text-body-secondary pt-3">
                    <img src="{% static 'img/iconos/persona.png' %}"  class="flex-shrink-0 me-2 rounded" width="32" height="32" alt="Descripción de la imagen">
                    <p class="pb-3 mb-0 small lh-sm border-bottom">
                        <strong class="d-block text-gray-dark">Informacion personal</strong>
                        En este segmento debe ingresar informacion de contacto.
                    </p>
                </div>
                

                <div class="col-md-6">
                  <label for="validationCustomUsername" class="form-label" >Rut</label>
                    <input type="text" class="form-control" id="validationCustomUsername" name="rut" aria-describedby="inputGroupPrepend" minlength="0" maxlength="10" required pattern="[0-9]+-[0-9kK]" title="Ingrese un RUT válido (ej: 12345678-9 o 12345678-K)" required>
                    <div class="valid-feedback">
                      Rut ingresado correctamente!
                    </div>
                    <div class="invalid-feedback">
                      Por favor ingresar Rut Correcto!
                    </div>
                </div><div class="col-md-6"></div>
          
                <div class="col-md-6">
                  <label for="validationCustom01" class="form-label">Nombre</label>
                  <input type="text" class="form-control" id="validationCustom01" name="nombre" required pattern="[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+" title="Solo se permiten letras y espacios" required>
                  <div class="valid-feedback">
                    Nombre ingresado correctaente!
                  </div>
                  <div class="invalid-feedback">
                    Nombre ingresado con error!
                  </div>
                </div>
          
                <div class="col-md-6">
                  <label for="validationCustom02" class="form-label">Apellido</label>
                  <input type="text" class="form-control" id="validationCustom02" name="apellido" required pattern="[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+" title="Solo se permiten letras y espacios" required>
                  <div class="valid-feedback">
                    Apellido ingresado correctamente!
                  </div>
                  <div class="invalid-feedback">
                    Favor ingresar apellido Correcto!
                  </div>
                </div>
          
                <div class="col-md-6">
                  <label for="validationCustomUsername" class="form-label">Correo</label>
                  <div class="input-group has-validation">
                    <input type="email" class="form-control" id="validationCustomUsername" name="correo" aria-describedby="inputGroupPrepend" required>
                    <div class="valid-feedback">
                      Correo ingresado correctamente!
                    </div>
                    <div class="invalid-feedback">
                      Por favor ingresar Correo Correcto!
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <label for="validationCustomUsername" class="form-label">Telefono</label>
                  <div class="input-group has-validation">
                    <input type="text" class="form-control" id="validationCustomUsername" name="telefono" aria-describedby="inputGroupPrepend" required>
                    <div class="valid-feedback">
                      telefono ingresado correctamente!
                    </div>
                    <div class="invalid-feedback">
                      Por favor ingresar telefono Correcto!
                    </div>
                  </div>
                </div>

                

                <div class="d-flex text-body-secondary pt-3">
                    <img src="{% static 'img/iconos/inf_credito.png' %}"  class="flex-shrink-0 me-2 rounded" width="32" height="32" alt="Descripción de la imagen">
                    <p class="pb-3 mb-0 small lh-sm border-bottom">
                        <strong class="d-block text-gray-dark">Informacion de evaluacion de credito</strong>
                        En este segmento debe ingresar informacion del credito que necesite evaluar.
                    </p>
                </div>
          
                <div class="col-md-6">
                  <label for="validationCustom03" class="form-label">Monto $</label>
                  <input type="text" class="form-control" id="validationCustom03" name="monto" required>
                  <div class="valid-feedback">
                    Monto ingresado correctamente!
                  </div>
                  <div class="invalid-feedback">
                    Favor ingresar un monto de credito Correcto!
                  </div>
                </div>

                <div class="col-md-6"> 
                    <label for="plazo" class="form-label">Plazo</label> 
                    <select class="form-select" id="plazo" name="plazo" required>
                        <option value="">Seleccione plazo...</option>
                        <!-- Opciones de plazo de 12 a 48 meses -->
                        <option value="12">12 meses</option>
                        <option value="24">24 meses</option>
                        <option value="36">36 meses</option>
                        <option value="48">48 meses</option>
                    </select>
                    <div class="invalid-feedback">
                        Por favor seleccione un plazo válido.
                    </div>
                </div>
                
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="fecha">Fecha:</label>
                    <input type="text" class="form-control datepicker" id="fecha" name="fecha" placeholder="Selecciona una fecha" required>
                    <div class="invalid-feedback">
                      Por favor seleccione una fecha.
                    </div>
                  </div>
                </div>


                <div class="col-12">
                  <button class="btn btn-primary" type="submit" >Registrar</button>
                </div>
            </form>
                    
            <!-- Modal -->
          <div class="modal fade" id="resultadoModal" tabindex="-1" aria-labelledby="resultadoModalLabel" aria-hidden="true">
          <div class="modal-dialog">
              <div class="modal-content">
                <div class="nav-scroller bg-body shadow-sm">
                  <nav class="nav" aria-label="Secondary navigation">
                      <div class="w-100 d-flex justify-content-center mt-2">
                          <img src="{% static 'img/index/socioscoop2.png' %}" class="rounded" alt="..." style="width: 200px; height: auto;">
                      </div>
                  </nav>
                </div> 
                  <div class="modal-header">
                      <h5 class="modal-title" id="resultadoModalLabel">Resultado de Evaluación de Crédito</h5>

                  </div>
                  <form action="/simulaCredito/formulario2" class="row g-3 needs-validation" method="POST" novalidate>
                    {% csrf_token %} 
                    <div class="modal-body">
                        <table class="table table-bordered">
                            <tr>
                                <th>Nombre</th>
                                <td>{{ nombre }} {{ apellido }}</td>
                            </tr>
                            <tr>
                                <th>Rut</th>
                                <td>{{ rut }}</td>
                            </tr>
                            <tr>
                                <th>Correo</th>
                                <td>{{ correo }}</td>
                            </tr>
                            <tr>
                              <th>Telefono</th>
                              <td>{{ telefono }}</td>
                          </tr>
                            <tr>
                                <th>Monto</th>
                                <td>{{ monto }}</td>
                            </tr>
                            <tr>
                                <th>Plazo</th>
                                <td>{{ plazo }} meses</td>
                            </tr>
                            <tr>
                                <th>Valor Cuota</th>
                                <td>{{ valor_cuota }}</td>
                            </tr>
                            <tr>
                                <th>Tasa</th>
                                <td>{{ tasa }}</td>
                            </tr>
                            <tr>
                                <th>Fecha del Primer Vencimiento</th>
                                <td>{{ fecha }}</td>
                            </tr>
                        </table>
                  
                        <!-- Inputs ocultos para enviar los datos -->
                        <input type="hidden" name="nombre" value="{{ nombre }} {{ apellido }}">
                        <input type="hidden" name="rut" value="{{ rut }}">
                        <input type="hidden" name="correo" value="{{ correo }}">
                        <input type="hidden" name="telefono" value="{{ telefono }}">
                        <input type="hidden" name="monto" value="{{ monto }}">
                        <input type="hidden" name="plazo" value="{{ plazo }}">
                        <input type="hidden" name="valor_cuota" value="{{ valor_cuota }}">
                        <input type="hidden" name="tasa" value="{{ tasa }}">
                        <input type="hidden" name="fecha" value="{{ fecha }}">
                    </div>
                  
                    <div class="modal-footer">
                      <button type="submit" class="btn btn-secondary" data-dismiss="modal">Enviar Guardar</button>
                    </div>

                  </form>
                  

              </div>
          </div>
          </div>
      
        </div>
       </div>       
      </div>     
     </main>
</body>
    

<!-- Script para seleccionar fecha -->
<script> 
$(document).ready(function(){
  // Asegurarse de que las variables están definidas antes de intentar abrir el modal
  var nombre = "{{ nombre }}";
  var rut = "{{ rut }}";
  var valor_cuota = "{{ valor_cuota }}";
  
  if (nombre && rut && valor_cuota) {
      $('#resultadoModal').modal('show');
  }
});
</script>
<script src="{% static 'js/socioscoop/fecha.js' %}"></script>
<!-- Abrir el modal automáticamente si hay datos disponibles 
<script src="{% static 'js/socioscoop/llamarPopup.js' %}"></script> -->
<!-- Validar formularios -->
<script src="{% static 'js/socioscoop/validaformularios.js' %}"></script>
</html>
{% endblock %}